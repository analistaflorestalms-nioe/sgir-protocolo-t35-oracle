<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SGIR - Sistema de Gestão de Inteligência e Riscos - Protocolo T35">
    <meta name="author" content="NIOE Security Systems">
    <meta name="robots" content="noindex, nofollow">
    
    <!-- Title -->
    <title>SGIR - Protocolo T35 [MODO SEGURO]</title>
    
    <!-- External Dependencies -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400;500&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
    
    <!-- Local Stylesheets -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/layout.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%232f81f7' stroke-width='2'><path d='M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10'/><path d='m9 12 2 2 4-4'/></svg>">
</head>

<body class="antialiased">
    <!-- Global Scanline Effect -->
    <div class="scanline fixed top-0 left-0 w-full h-full pointer-events-none z-50"></div>

    <!-- Login Screen -->
    <div id="login-screen" class="login-screen">
        <!-- Boot Sequence Overlay -->
        <div id="boot-sequence" class="boot-sequence">
            <div class="space-y-1">
                <p class="font-mono text-sm">
                    <span class="text-accent-green">[SYSTEM]</span> 
                    SGIR Security Bootloader v7.0 Oracle...
                </p>
                <p class="font-mono text-sm">
                    <span class="text-accent-green">[INIT]</span> 
                    Initializing NIOE Secure Environment...
                </p>
                <p class="font-mono text-sm">
                    <span class="text-accent-green">[AUTH]</span> 
                    T35 Protocol Handshake: 
                    <span id="boot-status" class="text-accent-yellow">CONNECTING...</span>
                </p>
                <p class="hidden boot-hidden font-mono text-sm">
                    <span class="text-accent-green">[CRYPTO]</span> 
                    Encrypted Channel Established.
                </p>
                <p class="hidden boot-hidden font-mono text-sm">
                    <span class="text-accent-green">[AUTH]</span> 
                    Loading User Authentication Module...
                </p>
                <p class="hidden boot-hidden font-mono text-sm">
                    <span class="text-accent-green">[READY]</span> 
                    All systems nominal. Welcome, Analyst.
                </p>
            </div>
        </div>

        <!-- Login Form -->
        <div id="login-form-container" class="login-container">
            <!-- Logo -->
            <div class="mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" 
                     fill="none" stroke="currentColor" stroke-width="1.5" 
                     class="mx-auto text-primary animate-pulse">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/>
                    <path d="m9 12 2 2 4-4"/>
                </svg>
            </div>

            <!-- Title -->
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-foreground font-mono">
                    NIOE // PROTOCOLO T35
                </h1>
                <p class="text-primary font-mono text-sm tracking-widest mt-2">
                    S.G.I.R - TERMINAL SEGURO
                </p>
            </div>

            <!-- Login Card -->
            <div class="card glass-effect p-8 shadow-2xl">
                <form id="login-form" class="space-y-6">
                    <div>
                        <label for="username" class="sr-only">Identidade</label>
                        <select id="username" class="form-input w-full font-mono" required
                                aria-label="Selecionar identidade de usuário">
                            <option value="" disabled selected>== SELECIONAR IDENTIDADE ==</option>
                            <option value="Aleluia">Aleluia (Industrial SP)</option>
                            <option value="Fábio">Fábio (Florestal SP)</option>
                            <option value="G. Silva">G. Silva (Florestal MS)</option>
                            <option value="Keven">Keven (Industrial BA)</option>
                            <option value="Geovana">Geovana (Portuária SP-Porto)</option>
                            <option value="Gideonis">Gideonis (Supervisor)</option>
                            <option value="Laio">Laio (Gerente)</option>
                            <option value="Pithon">Pithon (Diretor)</option>
                        </select>
                    </div>

                    <div>
                        <label for="password" class="sr-only">Senha</label>
                        <input type="password" id="password" class="form-input w-full font-mono" 
                               value="************" readonly
                               aria-label="Campo de senha (simulação)">
                    </div>

                    <button type="submit" 
                            class="w-full flex items-center justify-center p-3 font-mono text-lg btn btn-primary">
                        <i data-lucide="arrow-right-circle" class="mr-2 h-5 w-5" aria-hidden="true"></i>
                        INICIAR SESSÃO
                    </button>
                </form>
            </div>

            <!-- Security Notice -->
            <p class="text-xs text-center text-secondary mt-6 font-mono">
                ⚠️ Acesso restrito. Atividade monitorada.
            </p>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app" class="hidden app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Sidebar Header -->
            <div class="sidebar-header">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" 
                     fill="none" stroke="currentColor" stroke-width="1.5" 
                     class="h-8 w-8 text-primary" aria-hidden="true">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/>
                    <path d="m9 12 2 2 4-4"/>
                </svg>
                <h1 class="ml-3 text-lg font-bold text-foreground font-mono">
                    PROTOCOLO T35
                </h1>
            </div>

            <!-- Navigation -->
            <nav class="sidebar-nav" role="navigation" aria-label="Menu principal">
                <a href="#" data-page="dashboard" class="nav-link active" 
                   role="menuitem" aria-current="page">
                    <i data-lucide="layout-dashboard" class="h-5 w-5" aria-hidden="true"></i>
                    Dashboard
                </a>
                <a href="#" data-page="intel" class="nav-link" role="menuitem">
                    <i data-lucide="archive" class="h-5 w-5" aria-hidden="true"></i>
                    Inteligência
                </a>
                <a href="#" data-page="tasks" class="nav-link" role="menuitem">
                    <i data-lucide="clipboard-check" class="h-5 w-5" aria-hidden="true"></i>
                    Central de Tarefas
                </a>
                <a href="#" data-page="background" class="nav-link" role="menuitem">
                    <i data-lucide="users" class="h-5 w-5" aria-hidden="true"></i>
                    Background Check
                </a>
                <a href="#" data-page="map" class="nav-link" role="menuitem">
                    <i data-lucide="map" class="h-5 w-5" aria-hidden="true"></i>
                    Mapa de Operações
                </a>
                <a href="#" data-page="osint" class="nav-link" role="menuitem">
                    <i data-lucide="rss" class="h-5 w-5" aria-hidden="true"></i>
                    OSINT Tracker
                </a>
            </nav>

            <!-- User Profile -->
            <div class="sidebar-footer">
                <div class="user-profile">
                    <img class="user-avatar" 
                         src="https://placehold.co/40x40/0d1117/58a6ff?text=U" 
                         alt="Avatar do usuário"
                         id="user-avatar">
                    <div class="user-info">
                        <p class="user-name" id="user-name">Usuário</p>
                        <p class="user-role" id="user-role">Carregando...</p>
                    </div>
                    <button id="logout-btn" 
                            class="ml-auto text-secondary hover:text-primary transition-colors"
                            title="Logout"
                            aria-label="Sair do sistema">
                        <i data-lucide="log-out" class="h-5 w-5" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="main-header">
                <h2 id="page-title" class="text-xl font-semibold text-foreground font-mono">
                    // DASHBOARD <span class="text-sm text-primary animate-pulse">_</span>
                </h2>
                
                <!-- Search -->
                <div class="search-container">
                    <i data-lucide="search" class="search-icon h-5 w-5" aria-hidden="true"></i>
                    <input id="global-search" 
                           type="search" 
                           placeholder="Buscar globalmente..." 
                           class="search-input form-input font-mono"
                           aria-label="Busca global no sistema">
                </div>
            </header>

            <!-- Page Content -->
            <div id="page-content-container" class="page-content">
                <!-- Conteúdo das páginas será renderizado aqui via JavaScript -->
                <div class="flex items-center justify-center h-64">
                    <div class="text-center">
                        <div class="spinner mx-auto mb-4"></div>
                        <p class="text-secondary font-mono">Carregando sistema...</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    
    <!-- Data Linking Modal -->
    <div id="data-linking-modal" class="modal-backdrop">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-accent-yellow flex items-center">
                    <i data-lucide="link" class="mr-2" aria-hidden="true"></i>
                    Vínculo de Inteligência Detectado
                </h3>
                <button onclick="modalManager.closeModal('data-linking-modal')" 
                        class="text-secondary hover:text-foreground text-2xl"
                        aria-label="Fechar modal">&times;</button>
            </div>
            <div id="data-linking-content" class="text-sm">
                <!-- Conteúdo será preenchido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- Document View Modal -->
    <div id="doc-view-modal" class="modal-backdrop">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 id="doc-view-title" class="text-xl font-bold text-primary font-mono">
                    Documento
                </h3>
                <button onclick="modalManager.closeModal('doc-view-modal')" 
                        class="text-secondary hover:text-foreground text-2xl"
                        aria-label="Fechar modal">&times;</button>
            </div>
            <div id="doc-view-content" 
                 class="text-sm bg-background p-4 rounded-md border border-border max-h-[60vh] overflow-y-auto">
                <!-- Conteúdo será preenchido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- New Task Modal -->
    <div id="new-task-modal" class="modal-backdrop">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-primary font-mono">Delegar Nova Tarefa</h3>
                <button onclick="modalManager.closeModal('new-task-modal')" 
                        class="text-secondary hover:text-foreground text-2xl"
                        aria-label="Fechar modal">&times;</button>
            </div>
            <form id="new-task-form" class="space-y-4">
                <div>
                    <label for="task-title" class="block text-sm font-medium mb-2">Título da Tarefa</label>
                    <input type="text" id="task-title" name="title" 
                           placeholder="Ex: Revisar relatório de segurança..." 
                           class="form-input w-full" required>
                </div>
                
                <div>
                    <label for="task-assignee" class="block text-sm font-medium mb-2">Designar para</label>
                    <select id="task-assignee" name="assignedTo" class="form-select w-full" required>
                        <option value="">Selecionar usuário...</option>
                        <!-- Opções serão preenchidas dinamicamente -->
                    </select>
                </div>
                
                <div>
                    <label for="task-priority" class="block text-sm font-medium mb-2">Prioridade</label>
                    <select id="task-priority" name="priority" class="form-select w-full" required>
                        <option value="">Selecionar prioridade...</option>
                        <option value="Baixa">Baixa</option>
                        <option value="Média">Média</option>
                        <option value="Alta">Alta</option>
                        <option value="Crítica">Crítica</option>
                    </select>
                </div>
                
                <div>
                    <label for="task-description" class="block text-sm font-medium mb-2">Descrição (opcional)</label>
                    <textarea id="task-description" name="description" 
                              rows="3" placeholder="Detalhes adicionais sobre a tarefa..." 
                              class="form-textarea w-full"></textarea>
                </div>
                
                <div>
                    <label for="task-due-date" class="block text-sm font-medium mb-2">Prazo</label>
                    <input type="date" id="task-due-date" name="dueDate" class="form-input w-full">
                </div>
                
                <div class="flex justify-end gap-4 pt-4">
                    <button type="button" 
                            onclick="modalManager.closeModal('new-task-modal')" 
                            class="btn btn-secondary">
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Criar Tarefa
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- New RELINFO Modal -->
    <div id="new-relinfo-modal" class="modal-backdrop">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-primary font-mono">
                    Gerar Relatório de Informação (RELINFO)
                </h3>
                <button onclick="modalManager.closeModal('new-relinfo-modal')" 
                        class="text-secondary hover:text-foreground text-2xl"
                        aria-label="Fechar modal">&times;</button>
            </div>
            <form id="new-relinfo-form" class="space-y-4">
                <div>
                    <label for="relinfo-title" class="block text-sm font-medium mb-2">Título do Relatório</label>
                    <input type="text" id="relinfo-title" 
                           placeholder="Ex: Atividade suspeita na regional..." 
                           class="form-input w-full" required>
                </div>
                
                <div>
                    <label for="relinfo-content" class="block text-sm font-medium mb-2">Conteúdo</label>
                    <textarea id="relinfo-content" 
                              rows="8" 
                              placeholder="Descreva a informação coletada e seu potencial impacto operacional..." 
                              class="form-textarea w-full" required></textarea>
                </div>
                
                <div class="flex justify-end gap-4 pt-4">
                    <button type="button" 
                            onclick="modalManager.closeModal('new-relinfo-modal')" 
                            class="btn btn-secondary">
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn-primary">
                        Submeter RELINFO
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    
    <!-- Data Layer -->
    <script src="data/database.js"></script>
    
    <!-- Core Modules -->
    <script type="module" src="js/utils.js"></script>
    <script type="module" src="js/auth.js"></script>
    <script type="module" src="js/modals.js"></script>
    <script type="module" src="js/pages.js"></script>
    
    <!-- Main Application -->
    <script type="module" src="js/app.js"></script>

    <!-- Initialize Icons -->
    <script>
        // Ensure Lucide icons are created after all content is loaded
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });
    </script>
</body>
</html>
